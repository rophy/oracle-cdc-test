<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Performance Test Charts - 2025-12-20 18:38</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        h1 { color: #333; }
        h2 { color: #666; margin-top: 40px; }
        .chart-container {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .chart-wrapper {
            position: relative;
            height: 300px;
        }
        .summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .stat-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #2563eb;
        }
        .stat-label {
            color: #666;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <h1>Performance Test Charts</h1>
    <p>Test Date: 2025-12-20 18:38 UTC | Duration: 7 min (2 min rampup + 5 min test) | VUs: 12</p>

    <div class="summary">
        <div class="stat-card">
            <div class="stat-value">~324K</div>
            <div class="stat-label">Total DML Events</div>
        </div>
        <div class="stat-card">
            <div class="stat-value">897/s</div>
            <div class="stat-label">Peak Throughput</div>
        </div>
        <div class="stat-card">
            <div class="stat-value">5,265</div>
            <div class="stat-label">HammerDB Avg TPM</div>
        </div>
        <div class="stat-card">
            <div class="stat-value">44%</div>
            <div class="stat-label">Oracle Peak CPU</div>
        </div>
    </div>

    <h2>CPU Usage (%)</h2>
    <div class="chart-container">
        <div class="chart-wrapper">
            <canvas id="cpuChart"></canvas>
        </div>
    </div>

    <h2>Memory Usage (MB)</h2>
    <div class="chart-container">
        <div class="chart-wrapper">
            <canvas id="memChart"></canvas>
        </div>
    </div>

    <h2>OLR DML Processing Rate (events/sec)</h2>
    <div class="chart-container">
        <div class="chart-wrapper">
            <canvas id="dmlChart"></canvas>
        </div>
    </div>

    <h2>Events by Table</h2>
    <div class="chart-container">
        <div class="chart-wrapper">
            <canvas id="eventsChart"></canvas>
        </div>
    </div>

    <script>
        // Time labels (relative to test start)
        const timeLabels = [
            '0:00', '0:30', '1:00', '1:30', '2:00', '2:30', '3:00', '3:30', '4:00', '4:30',
            '5:00', '5:30', '6:00', '6:30', '7:00', '7:30', '8:00', '8:30', '9:00', '9:30', '10:00'
        ];

        // CPU data from Prometheus
        const oracleCpu = [22.7, 26.0, 30.9, 32.6, 17.4, 31.8, 27.0, 44.3, 39.2, 30.7, 25.7, 33.3, 26.8, 32.5, 20.1, 34.3, 27.4, 29.6, 38.8, 24.9, 13.4];
        const olrCpu = [0.5, 0.8, 1.7, 2.1, 0.3, 1.6, 2.0, 1.4, 2.2, 1.0, 1.0, 2.0, 1.5, 1.9, 0.9, 2.0, 1.3, 1.7, 1.7, 1.0, 0.4];

        // Memory data from Prometheus (in MB)
        const oracleMem = [11005, 8429, 8576, 8629, 8619, 8689, 8736, 8789, 8832, 8859, 8858, 8889, 8924, 8986, 9037, 9045, 9031, 9114, 9143, 9094, 8980];
        const olrMem = [2668, 33, 76, 129, 132, 183, 219, 263, 310, 330, 348, 392, 421, 459, 485, 513, 535, 580, 615, 649, 648];

        // DML rate from Prometheus (events/sec)
        const dmlRate = [1.2, 10.4, 553.9, 687.8, 310.7, 722.8, 488.6, 897.0, 797.9, 366.7, 352.3, 697.2, 407.6, 679.8, 0, 713.0, 678.8, 704.7, 707.8, 360.6, 1.2];

        // Events by table
        const eventsByTable = {
            labels: ['STOCK', 'CUSTOMER', 'DISTRICT', 'WAREHOUSE', 'HISTORY', 'ORDERS (ins)', 'ORDERS (upd)', 'commits'],
            data: [153922, 38253, 30844, 15451, 15451, 15393, 15070, 39235]
        };

        // CPU Chart
        new Chart(document.getElementById('cpuChart'), {
            type: 'line',
            data: {
                labels: timeLabels,
                datasets: [{
                    label: 'Oracle CPU %',
                    data: oracleCpu,
                    borderColor: '#ef4444',
                    backgroundColor: 'rgba(239, 68, 68, 0.1)',
                    fill: true,
                    tension: 0.3
                }, {
                    label: 'OLR CPU %',
                    data: olrCpu,
                    borderColor: '#22c55e',
                    backgroundColor: 'rgba(34, 197, 94, 0.1)',
                    fill: true,
                    tension: 0.3
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: { beginAtZero: true, title: { display: true, text: 'CPU %' } },
                    x: { title: { display: true, text: 'Time (mm:ss)' } }
                },
                plugins: {
                    annotation: {
                        annotations: {
                            rampup: {
                                type: 'box',
                                xMin: 0,
                                xMax: 4,
                                backgroundColor: 'rgba(255, 193, 7, 0.1)',
                                label: { content: 'Rampup', display: true }
                            }
                        }
                    }
                }
            }
        });

        // Memory Chart
        new Chart(document.getElementById('memChart'), {
            type: 'line',
            data: {
                labels: timeLabels,
                datasets: [{
                    label: 'Oracle Memory (MB)',
                    data: oracleMem,
                    borderColor: '#ef4444',
                    backgroundColor: 'rgba(239, 68, 68, 0.1)',
                    fill: true,
                    tension: 0.3,
                    yAxisID: 'y'
                }, {
                    label: 'OLR Memory (MB)',
                    data: olrMem,
                    borderColor: '#22c55e',
                    backgroundColor: 'rgba(34, 197, 94, 0.1)',
                    fill: true,
                    tension: 0.3,
                    yAxisID: 'y1'
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        type: 'linear',
                        position: 'left',
                        title: { display: true, text: 'Oracle (MB)' },
                        min: 8000,
                        max: 12000
                    },
                    y1: {
                        type: 'linear',
                        position: 'right',
                        title: { display: true, text: 'OLR (MB)' },
                        min: 0,
                        max: 3000,
                        grid: { drawOnChartArea: false }
                    },
                    x: { title: { display: true, text: 'Time (mm:ss)' } }
                }
            }
        });

        // DML Rate Chart
        new Chart(document.getElementById('dmlChart'), {
            type: 'line',
            data: {
                labels: timeLabels,
                datasets: [{
                    label: 'DML Rate (events/sec)',
                    data: dmlRate,
                    borderColor: '#2563eb',
                    backgroundColor: 'rgba(37, 99, 235, 0.2)',
                    fill: true,
                    tension: 0.3
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: { beginAtZero: true, title: { display: true, text: 'Events/sec' } },
                    x: { title: { display: true, text: 'Time (mm:ss)' } }
                }
            }
        });

        // Events by Table Chart
        new Chart(document.getElementById('eventsChart'), {
            type: 'bar',
            data: {
                labels: eventsByTable.labels,
                datasets: [{
                    label: 'Events',
                    data: eventsByTable.data,
                    backgroundColor: [
                        '#2563eb', '#7c3aed', '#db2777', '#ea580c',
                        '#16a34a', '#0891b2', '#4f46e5', '#64748b'
                    ]
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false }
                },
                scales: {
                    y: { beginAtZero: true, title: { display: true, text: 'Event Count' } }
                }
            }
        });
    </script>
</body>
</html>
