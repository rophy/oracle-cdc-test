# Deployment mode:
#   olr-only: OpenLogReplicator writes directly to file (no Kafka)
#   full: OLR -> Debezium -> Kafka -> kafka-consumer
mode: full

# Oracle Database configuration
oracle:
  image:
    repository: gvenzl/oracle-free
    tag: "23.9-slim"
    pullPolicy: IfNotPresent
  password: OraclePwd123
  resources:
    requests:
      memory: "2Gi"
      cpu: "1"
  persistence:
    enabled: true
    oradata:
      size: 30Gi
      storageClass: ""

# OpenLogReplicator configuration
olr:
  image:
    repository: rophy/openlogreplicator
    tag: "v1.8.7-5-g0cdc866"
    pullPolicy: IfNotPresent
  resources:
    requests:
      memory: "256Mi"
      cpu: "250m"
  persistence:
    checkpoint:
      size: 1Gi
      storageClass: ""
    output:
      size: 10Gi
      storageClass: ""

# Kafka configuration (only used in 'full' mode)
kafka:
  image:
    repository: apache/kafka
    tag: "3.9.0"
    pullPolicy: IfNotPresent
  resources:
    requests:
      memory: "1Gi"
      cpu: "500m"
  persistence:
    enabled: true
    size: 10Gi
    storageClass: ""

# Kafka Consumer configuration (only used in 'full' mode)
kafkaConsumer:
  image:
    repository: python
    tag: "3.11-slim"
    pullPolicy: IfNotPresent
  topicPattern: "oracle.*"
  resources:
    requests:
      memory: "64Mi"
      cpu: "100m"
  persistence:
    enabled: true
    size: 1Gi
    storageClass: ""

# Debezium Server configuration (only used in 'full' mode)
debezium:
  image:
    repository: rophy/debezium-server
    tag: "3.3.2-4d8ca7f"
    pullPolicy: IfNotPresent
  resources:
    requests:
      memory: "512Mi"
      cpu: "500m"
  persistence:
    enabled: true
    size: 1Gi
    storageClass: ""
  # Oracle connection settings
  oracle:
    hostname: "oracle"
    port: 1521
    user: "c##dbzuser"
    password: "dbzpwd"
    dbname: "FREE"
    pdbName: "FREEPDB1"
  # CDC settings
  topicPrefix: "oracle"
  schemaIncludeList: "USR1,TPCC"
  snapshotMode: "initial"

# HammerDB performance testing configuration
hammerdb:
  image:
    repository: tpcorg/hammerdb
    tag: "v4.10"
    pullPolicy: IfNotPresent
  virtualUsers: 8
  resources:
    requests:
      memory: "512Mi"
      cpu: "500m"
  # Oracle connection settings
  oracle:
    systemPassword: "OraclePwd123"
    port: 1521
    serviceName: "FREEPDB1"
  # TPROC-C benchmark settings
  tpcc:
    user: "TPCC"
    password: "TPCCPWD"
    tablespace: "TBLS1"
    warehouses: 10
    buildVirtualUsers: 4
    runVirtualUsers: 4
    allWarehouses: false
    rampupMinutes: 2
    durationMinutes: 5

# Prometheus stack (kube-prometheus-stack subchart)
prometheus:
  # Set to true to deploy Prometheus Operator and Grafana
  enabled: true

# kube-prometheus-stack subchart values (only used when prometheus.enabled=true)
kube-prometheus-stack:
  # Install CRDs with the chart
  crds:
    enabled: true
  # Disable components not needed for this use case
  alertmanager:
    enabled: false
  grafana:
    enabled: false
  nodeExporter:
    enabled: true
  kubeStateMetrics:
    enabled: false
  # Enable kubelet for container CPU/memory metrics (cAdvisor)
  kubelet:
    enabled: true
  # Disable k8s control plane monitors
  kubeApiServer:
    enabled: false
  kubeControllerManager:
    enabled: false
  coreDns:
    enabled: false
  kubeEtcd:
    enabled: false
  kubeScheduler:
    enabled: false
  kubeProxy:
    enabled: false
  # Prometheus server config
  prometheus:
    prometheusSpec:
      # Discover all ServiceMonitors in namespace
      serviceMonitorSelectorNilUsesHelmValues: false
      podMonitorSelectorNilUsesHelmValues: false
      # Retain data for 7 days
      retention: 7d
      # Storage
      storageSpec:
        volumeClaimTemplate:
          spec:
            accessModes: ["ReadWriteOnce"]
            resources:
              requests:
                storage: 10Gi

# Metrics exporters
metrics:
  # Oracle database metrics exporter
  oracleExporter:
    image:
      repository: container-registry.oracle.com/database/observability-exporter
      tag: "2.2.0"
      pullPolicy: IfNotPresent
    resources:
      requests:
        memory: "64Mi"
        cpu: "50m"
  # JMX exporter for Debezium (sidecar in full mode)
  jmxExporter:
    image:
      repository: sscaling/jmx-prometheus-exporter
      tag: "0.12.0"
      pullPolicy: IfNotPresent
  # Kafka exporter (only in full mode)
  kafkaExporter:
    enabled: true
    image:
      repository: danielqsj/kafka-exporter
      tag: "v1.7.0"
      pullPolicy: IfNotPresent
  # ServiceMonitor for Prometheus Operator
  serviceMonitor:
    # Enable to create ServiceMonitor resources for Prometheus Operator
    enabled: true
    # Labels to add to ServiceMonitors (e.g., for Prometheus selector)
    labels: {}
    interval: "15s"
    scrapeTimeout: "10s"
